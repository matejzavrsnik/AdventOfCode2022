#include <gtest/gtest.h>

#include "day8.h"

using namespace aoc23;

TEST(aoc23, d8_p1)
{
   vec<string> input = read_file_lines("./res/aoc23/day8.txt");
   auto result = d8::p1(input);
   ASSERT_EQ(18727, result);
}

TEST(aoc23, d8_pattern)
{
   vec<ll> v = {
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 803, 292, 73, 219, 219, 511, 219, 292, 1095, 146, 146, 1022, 365, 219, 1825, 803, 1752, 73, 1168, 146, 146, 73, 73, 292, 73, 438, 73,
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 803, 292, 73, 219, 219, 511, 219, 292, 1095, 146, 146, 1022, 365, 219, 1825, 803, 1752, 73, 1168, 146, 146, 73, 73, 292, 73, 438, 73,
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 803, 292, 73, 219, 219, 511, 219, 292, 1095, 146, 146, 1022, 365, 219, 1825, 803, 1752, 73, 1168, 146, 146, 73, 73, 292, 73, 438, 73,
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 803, 292, 73, 219, 219, 511, 219, 292, 1095, 146, 146, 1022, 365, 219, 1825, 803, 1752, 73, 1168, 146, 146, 73, 73, 292, 73, 438, 73,
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 99499};

   vec<ll> repeated = {
      219, 292, 292, 219, 146, 584, 73, 438, 511, 365, 146, 1533, 3139, 1387, 73, 73, 365, 803, 292, 73, 219, 219, 511, 219, 292, 1095, 146, 146, 1022, 365, 219, 1825, 803, 1752, 73, 1168, 146, 146, 73, 73, 292, 73, 438, 73
   };

   auto pattern = d8::find_repeated_pattern(v, v.begin());
   ASSERT_TRUE(pattern.has_value());

   vec<ll> pattern_vec(pattern.value().first, pattern.value().second);
   ASSERT_EQ(repeated, pattern_vec);
}

TEST(aoc23, d8_p2)
{
   vec<string> input = read_file_lines("./res/aoc23/day8.txt");
   auto result = d8::p2(input);
   // 11090890 too low
   // 7165446476 too low
   ASSERT_EQ(18024643846273, result);
}